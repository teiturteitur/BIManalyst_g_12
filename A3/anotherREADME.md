# A3 – Ventilation Analysis Tool  
### *Group 10 — Advanced BIM E25*  
**s214310 · s203493 · s201348**

---

## Table of Contents
1. [Introduction](#introduction)
2. [Module Overview](#module-overview)
   - [AirflowEstimator.py](#1-airflowestimatorpy)
   - [VentilationSystemAnalyzer.py](#2-ventilationsystemanalyzerpy)
   - [BcfGenerator.py](#3-bcfgeneratorpy)
3. [Installation](#installation)
4. [Usage](#usage)
   - [CLI_main.py](#1-cli_mainpy)
   - [main.py](#2-mainpy)
5. [Future Work](#future-work)

---

## Introduction

The **Ventilation Analysis Tool** is designed for use in the **early design phases** of HVAC modelling, helping identify errors or oversights before they propagate into later stages.

The tool is composed of **three independent modules**, each of which can be replaced or extended without affecting the others.

> _Images and diagrams will be added soon._

---

## Module Overview

### 1. AirflowEstimator.py

This module estimates airflow requirements for all spaces found in an **ARCH IFC file** (from the Advanced Building Design 41936 course at DTU).

Airflows are derived using **IEQ categories** defined in *DS/EN 16798-1:2019*.

**Occupancy is determined using the following priority:**

1. If occupancy is defined in a **PSET**, it is used.  
2. If no PSET is available, the number of **chairs** in a space is used.  
3. If neither PSET nor chairs are found, a fallback **occupant density** is estimated using:
   - `space.LongName`, or  
   - backup densities (Appendix B in the standard)

Missing PSETS are automatically added and the updated IFC file is saved in the `OutputFiles` folder.

---

### 2. VentilationSystemAnalyzer.py

This module analyzes all ventilation systems in an **MEP IFC file** and cross-references them with spaces in a matching ARCH IFC file.

Elements that fail required checks are stored in dictionaries for later **BCF issue generation**.

#### Checks performed:

1. **AHU Assignment**  
   - Systems without an AHU are added to the `missingAHUsystems` dictionary.  
   - Systems containing an AHU are paired with supply/return systems referenced by the same AHU.

2. **Air Terminal Clash Detection**  
   - Terminals outside any space → added to `unassignedTerminals`.  
   - Terminals inside spaces proceed to the next steps.

#### Analysis steps for passing terminals:

3. Divides required airflow (from room PSETs) among terminals within the space.  
4. Builds data trees to visualize airflow branching.  
5. Calculates pressure loss:  
   - For ducts: hydraulic diameter (round/rectangular).  
   - For fittings: fitting type and ports identified (calculations partially implemented).

---

### 3. BcfGenerator.py

Generates **BCF files** using the issue dictionaries generated by the previous modules.

Each issue includes:
- Camera viewpoints  
- Descriptions  
- References to offending IFC elements  

---

## Installation

This project uses **uv** as the environment and package manager.  
To install and prepare the environment:

```bash
# Create and sync environment
uv sync

# Activate the environment
uv venv
source .venv/bin/activate   # macOS / Linux
.venv\Scripts\activate      # Windows (PowerShell)
```
